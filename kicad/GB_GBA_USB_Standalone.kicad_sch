(kicad_sch
	(version 20231120)
	(generator "eeschema")
	(generator_version "8.0")
	(uuid "gb-gba-usb-standalone")
	(paper "A3")
	(title_block
		(title "UFI GB/GBA USB Cartridge Reader")
		(date "2026-01-17")
		(rev "1.0")
		(company "UFI Project")
		(comment 1 "Standalone USB Module - RP2040 Based")
		(comment 2 "Game Boy + Game Boy Advance Support")
		(comment 3 "Hammond 1551K Enclosure Compatible")
		(comment 4 "BOM: ~€12")
	)

	(lib_symbols
	)

	(text "╔════════════════════════════════════════════════════════════════════════════════════════════════╗
║                    GB/GBA USB CARTRIDGE READER - STANDALONE MODULE                              ║
║                                     RP2040 Based Design                                         ║
╠════════════════════════════════════════════════════════════════════════════════════════════════╣
║                                                                                                ║
║  ┌─────────────────────────────────────────────────────────────────────────────────────────┐   ║
║  │                                    BLOCK DIAGRAM                                        │   ║
║  │                                                                                         │   ║
║  │     ┌─────────────┐                                                                     │   ║
║  │     │   USB-C     │                                                                     │   ║
║  │     │  Connector  │                                                                     │   ║
║  │     └──────┬──────┘                                                                     │   ║
║  │            │                                                                            │   ║
║  │            │ D+/D-                                                                      │   ║
║  │            ▼                                                                            │   ║
║  │     ┌─────────────────────────────────────────────────────────┐                        │   ║
║  │     │                        RP2040                            │                        │   ║
║  │     │                                                          │                        │   ║
║  │     │  ┌────────┐  ┌────────┐  ┌────────┐  ┌────────────────┐ │                        │   ║
║  │     │  │ USB    │  │ Dual   │  │ PIO    │  │ GPIO 0-29      │ │                        │   ║
║  │     │  │ 1.1 FS │  │ M0+    │  │ x2     │  │                │ │                        │   ║
║  │     │  │        │  │ 133MHz │  │        │  │ D[0:7]  A[0:15]│ │                        │   ║
║  │     │  └────────┘  └────────┘  └────────┘  │ ~RD ~WR ~CS    │ │                        │   ║
║  │     │                                      └────────┬───────┘ │                        │   ║
║  │     └───────────────────────────────────────────────┼─────────┘                        │   ║
║  │                                                     │                                   │   ║
║  │                                                     ▼                                   │   ║
║  │     ┌───────────────────────────────────────────────────────────────────┐              │   ║
║  │     │                    74LVC4245A x2 (Level Shifters)                 │              │   ║
║  │     │                                                                   │              │   ║
║  │     │    3.3V Side (RP2040)              5V/3.3V Side (Cartridge)      │              │   ║
║  │     │    ◄──────────────────────────────►                              │              │   ║
║  │     └───────────────────────────────────────────────────────────────────┘              │   ║
║  │                              │                           │                              │   ║
║  │                              ▼                           ▼                              │   ║
║  │     ┌─────────────────────────────────┐  ┌─────────────────────────────────┐          │   ║
║  │     │      GAME BOY SLOT              │  │      GBA SLOT                   │          │   ║
║  │     │      32-pin, 5V logic           │  │      32-pin, 3.3V logic         │          │   ║
║  │     │      DMG / GBC compatible       │  │      GBA compatible             │          │   ║
║  │     └─────────────────────────────────┘  └─────────────────────────────────┘          │   ║
║  │                                                                                         │   ║
║  └─────────────────────────────────────────────────────────────────────────────────────────┘   ║
║                                                                                                ║
╠════════════════════════════════════════════════════════════════════════════════════════════════╣
║                                                                                                ║
║  RP2040 PIN ASSIGNMENT:                                                                        ║
║  ┌────────────────────────────────────────────────────────────────────────────────────────┐   ║
║  │ GPIO  │ Signal   │ Dir │ Description              │ Level Shifter                     │   ║
║  ├───────┼──────────┼─────┼──────────────────────────┼───────────────────────────────────┤   ║
║  │ GP0   │ D0       │ I/O │ Data bit 0               │ U2.A0 ↔ U2.B0                     │   ║
║  │ GP1   │ D1       │ I/O │ Data bit 1               │ U2.A1 ↔ U2.B1                     │   ║
║  │ GP2   │ D2       │ I/O │ Data bit 2               │ U2.A2 ↔ U2.B2                     │   ║
║  │ GP3   │ D3       │ I/O │ Data bit 3               │ U2.A3 ↔ U2.B3                     │   ║
║  │ GP4   │ D4       │ I/O │ Data bit 4               │ U2.A4 ↔ U2.B4                     │   ║
║  │ GP5   │ D5       │ I/O │ Data bit 5               │ U2.A5 ↔ U2.B5                     │   ║
║  │ GP6   │ D6       │ I/O │ Data bit 6               │ U2.A6 ↔ U2.B6                     │   ║
║  │ GP7   │ D7       │ I/O │ Data bit 7               │ U2.A7 ↔ U2.B7                     │   ║
║  ├───────┼──────────┼─────┼──────────────────────────┼───────────────────────────────────┤   ║
║  │ GP8   │ A0       │ Out │ Address bit 0            │ U1.A0 → U1.B0                     │   ║
║  │ GP9   │ A1       │ Out │ Address bit 1            │ U1.A1 → U1.B1                     │   ║
║  │ GP10  │ A2       │ Out │ Address bit 2            │ U1.A2 → U1.B2                     │   ║
║  │ GP11  │ A3       │ Out │ Address bit 3            │ U1.A3 → U1.B3                     │   ║
║  │ GP12  │ A4       │ Out │ Address bit 4            │ U1.A4 → U1.B4                     │   ║
║  │ GP13  │ A5       │ Out │ Address bit 5            │ U1.A5 → U1.B5                     │   ║
║  │ GP14  │ A6       │ Out │ Address bit 6            │ U1.A6 → U1.B6                     │   ║
║  │ GP15  │ A7       │ Out │ Address bit 7            │ U1.A7 → U1.B7                     │   ║
║  ├───────┼──────────┼─────┼──────────────────────────┼───────────────────────────────────┤   ║
║  │ GP16  │ A8       │ Out │ Address bit 8            │ Direct (active low active low active low active low active low active low active low) or ext shift                 │   ║
║  │ GP17  │ A9       │ Out │ Address bit 9            │                                   │   ║
║  │ GP18  │ A10      │ Out │ Address bit 10           │                                   │   ║
║  │ GP19  │ A11      │ Out │ Address bit 11           │                                   │   ║
║  │ GP20  │ A12      │ Out │ Address bit 12           │                                   │   ║
║  │ GP21  │ A13      │ Out │ Address bit 13           │                                   │   ║
║  │ GP22  │ A14      │ Out │ Address bit 14           │                                   │   ║
║  │ GP26  │ A15      │ Out │ Address bit 15           │                                   │   ║
║  ├───────┼──────────┼─────┼──────────────────────────┼───────────────────────────────────┤   ║
║  │ GP23  │ ~RD      │ Out │ Read strobe (active low) │ Direct                            │   ║
║  │ GP24  │ ~WR      │ Out │ Write strobe             │ Direct                            │   ║
║  │ GP25  │ ~CS      │ Out │ Chip select              │ Direct                            │   ║
║  │ GP27  │ ~RST     │ Out │ Cartridge reset          │ Direct                            │   ║
║  │ GP28  │ CLK      │ Out │ PHI clock output         │ Direct                            │   ║
║  │ GP29  │ SLOT_SEL │ In  │ Switch input (0=GB)      │ Internal pull-up                  │   ║
║  └───────┴──────────┴─────┴──────────────────────────┴───────────────────────────────────┘   ║
║                                                                                                ║
╠════════════════════════════════════════════════════════════════════════════════════════════════╣
║                                                                                                ║
║  POWER SUPPLY:                                                                                 ║
║  ┌────────────────────────────────────────────────────────────────────────────────────────┐   ║
║  │                                                                                        │   ║
║  │   USB VBUS (5V) ──┬──────────────────────────────────────────► +5V Rail                │   ║
║  │                   │                                              (GB Cartridge VCC)    │   ║
║  │                   │                                                                    │   ║
║  │                   │      ┌─────────────────┐                                          │   ║
║  │                   └─────►│   AP2112K-3.3   │──────────────────► +3.3V Rail             │   ║
║  │                          │   LDO 600mA     │                     (RP2040, GBA VCC)     │   ║
║  │                          │                 │                                           │   ║
║  │                          │ VIN   VOUT  GND │                                          │   ║
║  │                          └───┬─────┬────┬──┘                                          │   ║
║  │                              │     │    │                                              │   ║
║  │                              │     │    └─────────────────────► GND                   │   ║
║  │                             ═╧═   ═╧═                                                  │   ║
║  │                            10µF  10µF                                                  │   ║
║  │                                                                                        │   ║
║  └────────────────────────────────────────────────────────────────────────────────────────┘   ║
║                                                                                                ║
╠════════════════════════════════════════════════════════════════════════════════════════════════╣
║                                                                                                ║
║  USB-C CONNECTION (USB 2.0 Device):                                                            ║
║  ┌────────────────────────────────────────────────────────────────────────────────────────┐   ║
║  │                                                                                        │   ║
║  │   USB-C Receptacle                     RP2040                                          │   ║
║  │   ┌──────────────┐                                                                     │   ║
║  │   │ VBUS ────────┼─────────────────────► +5V                                          │   ║
║  │   │              │                                                                     │   ║
║  │   │ D+ ──────────┼───────[27Ω]─────────► USB_DP (internal)                            │   ║
║  │   │              │                                                                     │   ║
║  │   │ D- ──────────┼───────[27Ω]─────────► USB_DM (internal)                            │   ║
║  │   │              │                                                                     │   ║
║  │   │ CC1 ─────────┼───────[5.1k]────────► GND                                          │   ║
║  │   │              │                                                                     │   ║
║  │   │ CC2 ─────────┼───────[5.1k]────────► GND                                          │   ║
║  │   │              │                                                                     │   ║
║  │   │ GND ─────────┼─────────────────────► GND                                          │   ║
║  │   └──────────────┘                                                                     │   ║
║  │                                                                                        │   ║
║  │   Note: 5.1kΩ on CC pins identifies device as UFP (sink)                              │   ║
║  │                                                                                        │   ║
║  └────────────────────────────────────────────────────────────────────────────────────────┘   ║
║                                                                                                ║
╠════════════════════════════════════════════════════════════════════════════════════════════════╣
║                                                                                                ║
║  LEVEL SHIFTER VOLTAGE SELECTION:                                                              ║
║  ┌────────────────────────────────────────────────────────────────────────────────────────┐   ║
║  │                                                                                        │   ║
║  │   SLOT_SEL Switch ──► GP29                                                             │   ║
║  │                       │                                                                │   ║
║  │                       ├──► 0 (GB Mode):  VCCB = 5V via P-MOSFET                       │   ║
║  │                       │                   GB slot VCC = 5V                             │   ║
║  │                       │                   GBA slot VCC = OFF                           │   ║
║  │                       │                                                                │   ║
║  │                       └──► 1 (GBA Mode): VCCB = 3.3V direct                           │   ║
║  │                                          GB slot VCC = OFF                             │   ║
║  │                                          GBA slot VCC = 3.3V                           │   ║
║  │                                                                                        │   ║
║  │   ┌──────────────────────────────────────────────────────────────────┐                │   ║
║  │   │                                                                  │                │   ║
║  │   │   +5V ────┬───[P-FET]───┬─────────────► VCCB (to 74LVC4245)     │                │   ║
║  │   │           │      │      │                                        │                │   ║
║  │   │           │   SLOT_SEL  │                                        │                │   ║
║  │   │           │      │      │                                        │                │   ║
║  │   │  +3.3V ───┴──────┴──────┘                                        │                │   ║
║  │   │                                                                  │                │   ║
║  │   └──────────────────────────────────────────────────────────────────┘                │   ║
║  │                                                                                        │   ║
║  └────────────────────────────────────────────────────────────────────────────────────────┘   ║
║                                                                                                ║
╠════════════════════════════════════════════════════════════════════════════════════════════════╣
║                                                                                                ║
║  BILL OF MATERIALS (BOM):                                                                      ║
║  ┌────────────────────────────────────────────────────────────────────────────────────────┐   ║
║  │ Ref      │ Description                    │ Package    │ Qty │ Price  │ Total        │   ║
║  ├──────────┼────────────────────────────────┼────────────┼─────┼────────┼──────────────┤   ║
║  │ U1       │ RP2040                         │ QFN-56     │  1  │ €0.70  │ €0.70        │   ║
║  │ U2       │ W25Q16JVSSIQ (Flash)           │ SOIC-8     │  1  │ €0.25  │ €0.25        │   ║
║  │ U3, U4   │ 74LVC4245A                     │ TSSOP-24   │  2  │ €0.40  │ €0.80        │   ║
║  │ U5       │ AP2112K-3.3 (LDO)              │ SOT-23-5   │  1  │ €0.15  │ €0.15        │   ║
║  │ Y1       │ 12MHz Crystal                  │ 3215       │  1  │ €0.10  │ €0.10        │   ║
║  │ J1       │ USB-C Receptacle               │ SMD        │  1  │ €0.30  │ €0.30        │   ║
║  │ J2       │ GB Cartridge Slot              │ Edge 32p   │  1  │ €1.50  │ €1.50        │   ║
║  │ J3       │ GBA Cartridge Slot             │ Edge 32p   │  1  │ €1.80  │ €1.80        │   ║
║  │ J4       │ 10-pin Header (UFI opt)        │ 2.54mm     │  1  │ €0.10  │ €0.10        │   ║
║  │ SW1      │ SPDT Slide Switch              │ SMD        │  1  │ €0.15  │ €0.15        │   ║
║  │ SW2, SW3 │ Tactile Button                 │ SMD 6x6    │  2  │ €0.05  │ €0.10        │   ║
║  │ LED1     │ WS2812B RGB LED                │ 5050       │  1  │ €0.10  │ €0.10        │   ║
║  │ Q1       │ SI2301 P-MOSFET                │ SOT-23     │  1  │ €0.05  │ €0.05        │   ║
║  │ R1-R2    │ 5.1kΩ                          │ 0402       │  2  │ €0.01  │ €0.02        │   ║
║  │ R3-R4    │ 27Ω                            │ 0402       │  2  │ €0.01  │ €0.02        │   ║
║  │ R5-R8    │ 10kΩ                           │ 0402       │  4  │ €0.01  │ €0.04        │   ║
║  │ C1-C8    │ 100nF                          │ 0402       │  8  │ €0.01  │ €0.08        │   ║
║  │ C9-C10   │ 1µF                            │ 0402       │  2  │ €0.02  │ €0.04        │   ║
║  │ C11-C12  │ 10µF                           │ 0805       │  2  │ €0.03  │ €0.06        │   ║
║  │ C13-C14  │ 15pF                           │ 0402       │  2  │ €0.01  │ €0.02        │   ║
║  │ PCB      │ 2-layer 80x50mm                │ -          │  1  │ €1.50  │ €1.50        │   ║
║  │ Enclosure│ Hammond 1551K                  │ -          │  1  │ €2.50  │ €2.50        │   ║
║  ├──────────┴────────────────────────────────┴────────────┴─────┴────────┼──────────────┤   ║
║  │                                                              TOTAL:   │   ~€12.38    │   ║
║  └───────────────────────────────────────────────────────────────────────┴──────────────┘   ║
║                                                                                                ║
╠════════════════════════════════════════════════════════════════════════════════════════════════╣
║                                                                                                ║
║  PCB LAYOUT NOTES:                                                                             ║
║  • Board size: 80mm x 50mm (fits Hammond 1551K)                                               ║
║  • 2-layer PCB, 1.6mm thick                                                                   ║
║  • Cartridge slots at top edge, USB-C at bottom edge                                          ║
║  • Keep crystal close to RP2040, short traces                                                 ║
║  • Ground plane on bottom layer                                                               ║
║  • USB traces: 90Ω differential impedance                                                     ║
║  • Mounting holes: 4x M2 at corners                                                           ║
║                                                                                                ║
║  ENCLOSURE CUTOUTS:                                                                            ║
║  • Top: 2x rectangular slots for cartridges                                                   ║
║  • Bottom: USB-C opening                                                                       ║
║  • Side: Slot selector switch access                                                          ║
║  • LED window (optional)                                                                       ║
║                                                                                                ║
╚════════════════════════════════════════════════════════════════════════════════════════════════╝"
		(exclude_from_sim no)
		(at 25.4 25.4 0)
		(effects
			(font
				(size 1.5 1.5)
			)
			(justify left top)
		)
		(uuid "main-schematic-notes")
	)

	(sheet_instances
		(path "/"
			(page "1")
		)
	)
)
