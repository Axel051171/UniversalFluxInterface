(kicad_sch
	(version 20231120)
	(generator "eeschema")
	(generator_version "8.0")
	(uuid "gb-gba-usb-dumper-root")
	(paper "A3")
	(title_block
		(title "GB/GBA USB Cartridge Dumper")
		(date "2026-01-17")
		(rev "1.0")
		(company "UFI Project")
		(comment 1 "Standalone USB Device - RP2040 Based")
		(comment 2 "Game Boy + Game Boy Advance Support")
		(comment 3 "PCB: 65x55mm, 2-Layer, Hammond 1593K Compatible")
		(comment 4 "BOM: ~€10")
	)

	(lib_symbols
	)

	(text "┏━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┓
┃                              GB/GBA USB CARTRIDGE DUMPER - SCHEMATIC                                    ┃
┃                                        RP2040 Based Design                                              ┃
┣━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┫
┃                                                                                                         ┃
┃  POWER SUPPLY                                                                                           ┃
┃  ═══════════                                                                                            ┃
┃                                                                                                         ┃
┃      USB-C (J1)                                                                                         ┃
┃      ┌─────────┐                                                                                        ┃
┃      │ VBUS────┼────────┬──────────────────────────────────────────────────────► +5V                    ┃
┃      │         │        │                                                          (GB Cart, Shifters)  ┃
┃      │ CC1─────┼──[5k1]─┤                                                                               ┃
┃      │         │        │      ┌───────────────────┐                                                    ┃
┃      │ CC2─────┼──[5k1]─┼─GND  │    AP2112K-3.3    │                                                    ┃
┃      │         │               │    U2             │                                                    ┃
┃      │ D+──────┼──[27Ω]────────┼────────────────────────────────────► RP2040 USB_DP                     ┃
┃      │         │               │ VIN    VOUT       │──────────────────► +3.3V                          ┃
┃      │ D-──────┼──[27Ω]────────┼────────────────────────────────────► RP2040 USB_DM   (RP2040, GBA)    ┃
┃      │         │               │        EN─────────┼──[10k]──+5V                                        ┃
┃      │ GND─────┼───────────────┤ GND               │                                                    ┃
┃      └─────────┘               └─────┬─────────────┘                                                    ┃
┃                                     ═╧═                                                                  ┃
┃                                     10µF                                                                 ┃
┃                                                                                                         ┃
┃  Decoupling: 100nF at each IC power pin, 10µF bulk at LDO output                                        ┃
┃                                                                                                         ┃
┣━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┫
┃                                                                                                         ┃
┃  RP2040 MICROCONTROLLER (U1)                                                                            ┃
┃  ═══════════════════════════                                                                            ┃
┃                                                                                                         ┃
┃                              ┌─────────────────────────────────────────────────────────────┐            ┃
┃                              │                        RP2040                                │            ┃
┃                              │                        QFN-56                                │            ┃
┃                              │                                                              │            ┃
┃   12MHz Crystal ────────────►│ XIN (20)                                                    │            ┃
┃   (Y1 + 15pF x2)             │ XOUT (21)                                                   │            ┃
┃                              │                                                              │            ┃
┃   W25Q16 Flash ◄────QSPI────►│ QSPI_SD0 (51)  GPIO0 (2) ───────────────────────────────────│──► D0     ┃
┃   (U3)                       │ QSPI_SD1 (52)  GPIO1 (3) ───────────────────────────────────│──► D1     ┃
┃                              │ QSPI_SD2 (53)  GPIO2 (4) ───────────────────────────────────│──► D2     ┃
┃                              │ QSPI_SD3 (54)  GPIO3 (5) ───────────────────────────────────│──► D3     ┃
┃                              │ QSPI_CLK (56)  GPIO4 (6) ───────────────────────────────────│──► D4     ┃
┃                              │ QSPI_CS (55)   GPIO5 (7) ───────────────────────────────────│──► D5     ┃
┃                              │                GPIO6 (8) ───────────────────────────────────│──► D6     ┃
┃   USB D+ ◄──────────────────►│ USB_DP (47)    GPIO7 (9) ───────────────────────────────────│──► D7     ┃
┃   USB D- ◄──────────────────►│ USB_DM (46)                                                 │            ┃
┃                              │                GPIO8 (11) ──────────────────────────────────│──► A0     ┃
┃   +1.1V (internal) ◄─────────│ VREG_OUT (45)  GPIO9 (12) ──────────────────────────────────│──► A1     ┃
┃                              │                GPIO10 (13) ─────────────────────────────────│──► A2     ┃
┃   +3.3V ────────────────────►│ DVDD (10,23,   GPIO11 (14) ─────────────────────────────────│──► A3     ┃
┃                              │      33,42,50) GPIO12 (15) ─────────────────────────────────│──► A4     ┃
┃   +3.3V ────────────────────►│ IOVDD (1,22,   GPIO13 (16) ─────────────────────────────────│──► A5     ┃
┃                              │       34,43)   GPIO14 (17) ─────────────────────────────────│──► A6     ┃
┃                              │                GPIO15 (18) ─────────────────────────────────│──► A7     ┃
┃   GND ──────────────────────►│ GND (57/PAD)                                                │            ┃
┃                              │                GPIO16 (27) ─────────────────────────────────│──► A8     ┃
┃   BOOT Button ──────────────►│ BOOTSEL (INT)  GPIO17 (28) ─────────────────────────────────│──► A9     ┃
┃   (to GND via 10k pullup)    │                GPIO18 (29) ─────────────────────────────────│──► A10    ┃
┃                              │                GPIO19 (30) ─────────────────────────────────│──► A11    ┃
┃   RUN Button ───────────────►│ RUN (26)       GPIO20 (31) ─────────────────────────────────│──► A12    ┃
┃   (to GND via 10k pullup)    │                GPIO21 (32) ─────────────────────────────────│──► A13    ┃
┃                              │                GPIO22 (34) ─────────────────────────────────│──► A14    ┃
┃                              │                GPIO26 (37) ─────────────────────────────────│──► A15    ┃
┃                              │                                                              │            ┃
┃                              │                GPIO23 (35) ─────────────────────────────────│──► ~RD    ┃
┃                              │                GPIO24 (36) ─────────────────────────────────│──► ~WR    ┃
┃                              │                GPIO25 (38) ─────────────────────────────────│──► LED    ┃
┃                              │                GPIO27 (39) ─────────────────────────────────│──► ~CS    ┃
┃                              │                GPIO28 (40) ─────────────────────────────────│──► ~RST   ┃
┃                              │                GPIO29 (41) ◄────────────────────────────────│─── SLOT   ┃
┃                              │                                                              │   SELECT  ┃
┃                              └──────────────────────────────────────────────────────────────┘            ┃
┃                                                                                                         ┃
┣━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┫
┃                                                                                                         ┃
┃  LEVEL SHIFTERS (74LVC245A)                                                                             ┃
┃  ══════════════════════════                                                                             ┃
┃                                                                                                         ┃
┃  U4: Data Bus (Bidirectional)                        U5: Address Low [0:7]                              ┃
┃  ┌───────────────────────────────┐                   ┌───────────────────────────────┐                  ┃
┃  │      74LVC245APW              │                   │      74LVC245APW              │                  ┃
┃  │                               │                   │                               │                  ┃
┃  │ VCCA (1) ◄── +3.3V           │                   │ VCCA (1) ◄── +3.3V           │                  ┃
┃  │ VCCB (20) ◄── VCC_CART       │                   │ VCCB (20) ◄── VCC_CART       │                  ┃
┃  │                               │                   │                               │                  ┃
┃  │ A1 (2) ◄──► D0 (RP2040)      │                   │ A1 (2) ◄── A0 (RP2040)       │                  ┃
┃  │ B1 (18) ◄──► D0 (CART)       │                   │ B1 (18) ──► A0 (CART)        │                  ┃
┃  │ A2 (3) ◄──► D1               │                   │ A2 (3) ◄── A1                │                  ┃
┃  │ B2 (17) ◄──► D1              │                   │ B2 (17) ──► A1               │                  ┃
┃  │ A3 (4) ◄──► D2               │                   │ A3 (4) ◄── A2                │                  ┃
┃  │ B3 (16) ◄──► D2              │                   │ B3 (16) ──► A2               │                  ┃
┃  │ A4 (5) ◄──► D3               │                   │ A4 (5) ◄── A3                │                  ┃
┃  │ B4 (15) ◄──► D3              │                   │ B4 (15) ──► A3               │                  ┃
┃  │ A5 (6) ◄──► D4               │                   │ A5 (6) ◄── A4                │                  ┃
┃  │ B5 (14) ◄──► D4              │                   │ B5 (14) ──► A4               │                  ┃
┃  │ A6 (7) ◄──► D5               │                   │ A6 (7) ◄── A5                │                  ┃
┃  │ B6 (13) ◄──► D5              │                   │ B6 (13) ──► A5               │                  ┃
┃  │ A7 (8) ◄──► D6               │                   │ A7 (8) ◄── A6                │                  ┃
┃  │ B7 (12) ◄──► D6              │                   │ B7 (12) ──► A6               │                  ┃
┃  │ A8 (9) ◄──► D7               │                   │ A8 (9) ◄── A7                │                  ┃
┃  │ B8 (11) ◄──► D7              │                   │ B8 (11) ──► A7               │                  ┃
┃  │                               │                   │                               │                  ┃
┃  │ DIR (19) ◄── ~RD             │                   │ DIR (19) ◄── +3.3V (A→B)    │                  ┃
┃  │ ~OE (10) ◄── GND (enabled)   │                   │ ~OE (10) ◄── GND             │                  ┃
┃  │                               │                   │                               │                  ┃
┃  │ GND (10) ──► GND             │                   │ GND (10) ──► GND             │                  ┃
┃  └───────────────────────────────┘                   └───────────────────────────────┘                  ┃
┃                                                                                                         ┃
┃  U6: Address High [8:15] + Control                                                                      ┃
┃  ┌───────────────────────────────┐                                                                      ┃
┃  │      74LVC245APW              │                                                                      ┃
┃  │                               │                                                                      ┃
┃  │ VCCA (1) ◄── +3.3V           │                                                                      ┃
┃  │ VCCB (20) ◄── VCC_CART       │                                                                      ┃
┃  │                               │                                                                      ┃
┃  │ A1 (2) ◄── A8 (RP2040)       │                                                                      ┃
┃  │ B1 (18) ──► A8 (CART)        │                                                                      ┃
┃  │ A2-A8 ... A9-A15             │                                                                      ┃
┃  │                               │                                                                      ┃
┃  │ DIR (19) ◄── +3.3V (A→B)    │                                                                      ┃
┃  │ ~OE (10) ◄── GND             │                                                                      ┃
┃  │ GND (10) ──► GND             │                                                                      ┃
┃  └───────────────────────────────┘                                                                      ┃
┃                                                                                                         ┃
┣━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┫
┃                                                                                                         ┃
┃  CARTRIDGE VOLTAGE SELECTION                                                                            ┃
┃  ═══════════════════════════                                                                            ┃
┃                                                                                                         ┃
┃                   SLOT_SEL (GPIO29)                                                                     ┃
┃                        │                                                                                ┃
┃                        ├────[10k]──── +3.3V (pull-up)                                                   ┃
┃                        │                                                                                ┃
┃        ┌───────────────┴───────────────┐                                                                ┃
┃        │         TS5A3159              │                                                                ┃
┃        │     (SPDT Analog Switch)      │                                                                ┃
┃        │                               │                                                                ┃
┃  +5V ──│── NO (Normally Open)          │                                                                ┃
┃        │                    COM ───────│───────────────────► VCC_CART                                   ┃
┃ +3.3V ─│── NC (Normally Closed)        │                     (to 74LVC245 VCCB)                         ┃
┃        │                               │                     (to Cartridge VCC)                         ┃
┃        │         SEL ◄─────────────────│─── SLOT_SEL                                                    ┃
┃        │         GND ──────────────────│─── GND                                                         ┃
┃        └───────────────────────────────┘                                                                ┃
┃                                                                                                         ┃
┃  SLOT_SEL = 0 (LOW):  VCC_CART = +3.3V (GBA Mode)                                                       ┃
┃  SLOT_SEL = 1 (HIGH): VCC_CART = +5V   (GB Mode)                                                        ┃
┃                                                                                                         ┃
┣━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┫
┃                                                                                                         ┃
┃  CARTRIDGE SLOTS                                                                                        ┃
┃  ═══════════════                                                                                        ┃
┃                                                                                                         ┃
┃  J2: GAME BOY SLOT (32-pin Edge Connector)           J3: GBA SLOT (32-pin Edge Connector)              ┃
┃  ┌───────────────────────────────────────┐           ┌───────────────────────────────────────┐          ┃
┃  │  1  VCC ◄── VCC_CART                  │           │  1  VCC ◄── VCC_CART                  │          ┃
┃  │  2  PHI ◄── CLK (optional)            │           │  2  PHI ◄── CLK                       │          ┃
┃  │  3  ~WR ◄── ~WR                       │           │  3  ~WR ◄── ~WR                       │          ┃
┃  │  4  ~RD ◄── ~RD                       │           │  4  ~RD ◄── ~RD                       │          ┃
┃  │  5  ~CS ◄── ~CS_GB                    │           │  5  ~CS ◄── ~CS_GBA                   │          ┃
┃  │  6  A0 ◄── A0                         │           │  6  AD0 ◄──► D0/A0 (mux)              │          ┃
┃  │  7-21 A1-A15                          │           │  7-21 AD1-AD15                        │          ┃
┃  │ 22  D0 ◄──► D0                        │           │ 22  A16 ◄── A16 (direct)              │          ┃
┃  │ 23-29 D1-D7                           │           │ 23-29 A17-A23                         │          ┃
┃  │ 30  ~RST ◄── ~RST                     │           │ 30  ~RST ◄── ~RST                     │          ┃
┃  │ 31  AUDIO ──► (optional)              │           │ 31  ~CS2 ◄── ~CS2 (SRAM select)      │          ┃
┃  │ 32  GND ──► GND                       │           │ 32  GND ──► GND                       │          ┃
┃  └───────────────────────────────────────┘           └───────────────────────────────────────┘          ┃
┃                                                                                                         ┃
┃  Note: GB slot active when SLOT_SEL=1 (5V), GBA slot active when SLOT_SEL=0 (3.3V)                     ┃
┃        ~CS active for selected slot only                                                                ┃
┃                                                                                                         ┃
┣━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┫
┃                                                                                                         ┃
┃  STATUS LED & BUTTONS                                                                                   ┃
┃  ════════════════════                                                                                   ┃
┃                                                                                                         ┃
┃  LED1 (Power/Activity):                                                                                 ┃
┃  ┌─────────────────────────────┐                                                                        ┃
┃  │                             │                                                                        ┃
┃  │  GPIO25 ──[330Ω]──►|── GND │      WS2812B (optional) for RGB status                                 ┃
┃  │            (LED)            │                                                                        ┃
┃  │                             │                                                                        ┃
┃  └─────────────────────────────┘                                                                        ┃
┃                                                                                                         ┃
┃  BOOT Button (SW1):              RESET Button (SW2):                                                    ┃
┃  ┌───────────────────┐           ┌───────────────────┐                                                  ┃
┃  │                   │           │                   │                                                  ┃
┃  │  BOOTSEL ──[BTN]──│── GND    │  RUN ─────[BTN]───│── GND                                            ┃
┃  │     │             │           │   │              │                                                   ┃
┃  │    [10k]── +3.3V  │           │  [10k]── +3.3V   │                                                   ┃
┃  │                   │           │                   │                                                  ┃
┃  └───────────────────┘           └───────────────────┘                                                  ┃
┃                                                                                                         ┃
┃  Slot Select Button (SW3):                                                                              ┃
┃  ┌─────────────────────────────────────────────┐                                                        ┃
┃  │                                             │                                                        ┃
┃  │  GPIO29 ──[slide switch]── GND or FLOAT    │      GND = GBA (3.3V)                                  ┃
┃  │     │                                       │      FLOAT = GB (5V, via pull-up)                     ┃
┃  │    [10k]── +3.3V                            │                                                        ┃
┃  │                                             │                                                        ┃
┃  └─────────────────────────────────────────────┘                                                        ┃
┃                                                                                                         ┃
┣━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┫
┃                                                                                                         ┃
┃  BILL OF MATERIALS                                                                                      ┃
┃  ═════════════════                                                                                      ┃
┃                                                                                                         ┃
┃  ┌─────────┬────────────────────────────────┬─────────────┬─────┬─────────┬───────────┐                ┃
┃  │ Ref     │ Component                      │ Package     │ Qty │ Price   │ Total     │                ┃
┃  ├─────────┼────────────────────────────────┼─────────────┼─────┼─────────┼───────────┤                ┃
┃  │ U1      │ RP2040                         │ QFN-56      │  1  │ €0.70   │ €0.70     │                ┃
┃  │ U2      │ AP2112K-3.3 (LDO)              │ SOT-23-5    │  1  │ €0.15   │ €0.15     │                ┃
┃  │ U3      │ W25Q16JVSNIQ (16Mbit Flash)    │ SOIC-8      │  1  │ €0.25   │ €0.25     │                ┃
┃  │ U4-U6   │ 74LVC245APW (Level Shifter)    │ TSSOP-20    │  3  │ €0.25   │ €0.75     │                ┃
┃  │ U7      │ TS5A3159 (SPDT Analog Switch)  │ SOT-23-6    │  1  │ €0.20   │ €0.20     │                ┃
┃  │ Y1      │ 12MHz Crystal                  │ 3.2x1.5mm   │  1  │ €0.10   │ €0.10     │                ┃
┃  │ J1      │ USB-C Receptacle               │ Mid-mount   │  1  │ €0.30   │ €0.30     │                ┃
┃  │ J2      │ GB Cartridge Slot              │ Edge 32-pin │  1  │ €1.50   │ €1.50     │                ┃
┃  │ J3      │ GBA Cartridge Slot             │ Edge 32-pin │  1  │ €1.80   │ €1.80     │                ┃
┃  │ SW1-2   │ Tactile Button                 │ 6x6mm SMD   │  2  │ €0.05   │ €0.10     │                ┃
┃  │ SW3     │ SPDT Slide Switch              │ SMD         │  1  │ €0.15   │ €0.15     │                ┃
┃  │ LED1    │ LED Green                      │ 0603        │  1  │ €0.02   │ €0.02     │                ┃
┃  │ R1-R2   │ 27Ω (USB)                      │ 0402        │  2  │ €0.01   │ €0.02     │                ┃
┃  │ R3-R4   │ 5.1kΩ (USB CC)                 │ 0402        │  2  │ €0.01   │ €0.02     │                ┃
┃  │ R5-R10  │ 10kΩ                           │ 0402        │  6  │ €0.01   │ €0.06     │                ┃
┃  │ R11     │ 330Ω (LED)                     │ 0402        │  1  │ €0.01   │ €0.01     │                ┃
┃  │ C1-C8   │ 100nF                          │ 0402        │  8  │ €0.01   │ €0.08     │                ┃
┃  │ C9-C10  │ 10µF                           │ 0603        │  2  │ €0.03   │ €0.06     │                ┃
┃  │ C11-C12 │ 15pF (Crystal)                 │ 0402        │  2  │ €0.01   │ €0.02     │                ┃
┃  │ C13     │ 1µF                            │ 0402        │  1  │ €0.02   │ €0.02     │                ┃
┃  │ PCB     │ 2-layer 65x55mm                │ -           │  1  │ €1.00   │ €1.00     │                ┃
┃  │ Case    │ Hammond 1593K or similar       │ -           │  1  │ €3.00   │ €3.00     │                ┃
┃  ├─────────┴────────────────────────────────┴─────────────┴─────┴─────────┼───────────┤                ┃
┃  │                                                           TOTAL:      │ ~€10.31   │                ┃
┃  └────────────────────────────────────────────────────────────────────────┴───────────┘                ┃
┃                                                                                                         ┃
┗━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┛"
		(exclude_from_sim no)
		(at 25.4 25.4 0)
		(effects
			(font
				(size 1.27 1.27)
			)
			(justify left top)
		)
		(uuid "schematic-text")
	)

	(sheet_instances
		(path "/"
			(page "1")
		)
	)
)
